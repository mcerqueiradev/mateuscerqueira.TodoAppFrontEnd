<div>
  <!-- Success Message -->
  @if (successMessage) {
  <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
    <div class="flex items-center">
      <span class="text-green-600 mr-2"
        ><svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 16 16"
          fill="currentColor"
          class="size-4"
        >
          <path
            fill-rule="evenodd"
            d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14Zm3.844-8.791a.75.75 0 0 0-1.188-.918l-3.7 4.79-1.649-1.833a.75.75 0 1 0-1.114 1.004l2.25 2.5a.75.75 0 0 0 1.15-.043l4.25-5.5Z"
            clip-rule="evenodd"
          />
        </svg>
      </span>
      <p class="text-green-700 text-sm">{{ successMessage }}</p>
    </div>
  </div>
  }

  <!-- General Error Message -->
  @if (errors.general) {
  <div class="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg">
    <div class="flex items-center">
      <span class="text-red-600 mr-2"
        ><svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 16 16"
          fill="currentColor"
          class="size-4"
        >
          <path
            fill-rule="evenodd"
            d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14Zm2.78-4.22a.75.75 0 0 1-1.06 0L8 9.06l-1.72 1.72a.75.75 0 1 1-1.06-1.06L6.94 8 5.22 6.28a.75.75 0 0 1 1.06-1.06L8 6.94l1.72-1.72a.75.75 0 1 1 1.06 1.06L9.06 8l1.72 1.72a.75.75 0 0 1 0 1.06Z"
            clip-rule="evenodd"
          />
        </svg>
      </span>
      <p class="text-red-700 text-sm">{{ errors.general }}</p>
    </div>
  </div>
  }

  <form (ngSubmit)="onSubmit()" class="space-y-4">
    <!-- Title Field -->
    <div>
      <label for="title" class="block text-sm font-medium text-gray-700 mb-1">
        Task Title *
      </label>
      <input
        type="text"
        id="title"
        name="title"
        [(ngModel)]="title"
        (input)="onInputChange('title')"
        [class.border-red-300]="showErrors && errors.title"
        [class.border-green-300]="showErrors && !errors.title && title"
        placeholder="Enter task title"
        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors placeholder:text-sm text-sm"
        [disabled]="isSubmitting"
      />
      <!-- Character Counter -->
      <div class="flex justify-between items-center mt-1">
        @if (showErrors && errors.title) {
        <p class="text-red-600 text-xs">{{ errors.title }}</p>
        } @else {
        <p class="text-gray-400 text-xs">Min. 3 characters</p>
        }
        <span
          [class.text-red-600]="title.length > 200"
          [class.text-gray-400]="title.length <= 200"
          class="text-xs"
        >
          {{ title.length }}/200
        </span>
      </div>
    </div>

    <!-- Description Field -->
    <div>
      <label
        for="description"
        class="block text-sm font-medium text-gray-700 mb-1"
      >
        Description (Optional)
      </label>
      <textarea
        id="description"
        name="description"
        [(ngModel)]="description"
        (input)="onInputChange('description')"
        [class.border-red-300]="showErrors && errors.description"
        [class.border-green-300]="
          showErrors && !errors.description && description
        "
        placeholder="Enter task description"
        rows="3"
        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors resize-vertical placeholder:text-sm text-sm"
        [disabled]="isSubmitting"
      ></textarea>
      <!-- Character Counter -->
      <div class="flex justify-between items-center mt-1">
        @if (showErrors && errors.description) {
        <p class="text-red-600 text-xs">{{ errors.description }}</p>
        } @else {
        <p class="text-gray-400 text-xs">Optional</p>
        }
        <span
          [class.text-red-600]="description.length > 1000"
          [class.text-gray-400]="description.length <= 1000"
          class="text-xs"
        >
          {{ description.length }}/1000
        </span>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="flex space-x-3 pt-2">
      <button
        type="button"
        (click)="resetForm()"
        [disabled]="isSubmitting"
        class="px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50"
      >
        Clear
      </button>
      <button
        type="submit"
        [disabled]="isSubmitting || !title.trim()"
        class="flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed"
      >
        @if (isSubmitting) {
        <span class="flex items-center justify-center">
          <div
            class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"
          ></div>
          Creating...
        </span>
        } @else { Create Task }
      </button>
    </div>

    <!-- Form Tips -->
    <div class="pt-4 border-t border-gray-200 flex items-start space-x-2">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 16 16"
        fill="currentColor"
        class="size-4 text-yellow-400"
      >
        <path
          d="M10.618 10.26c-.361.223-.618.598-.618 1.022 0 .226-.142.43-.36.49A6.006 6.006 0 0 1 8 12c-.569 0-1.12-.08-1.64-.227a.504.504 0 0 1-.36-.491c0-.424-.257-.799-.618-1.021a5 5 0 1 1 5.235 0ZM6.867 13.415a.75.75 0 1 0-.225 1.483 9.065 9.065 0 0 0 2.716 0 .75.75 0 1 0-.225-1.483 7.563 7.563 0 0 1-2.266 0Z"
        />
      </svg>
      <p class="text-xs text-gray-500">
        <strong>Tip:</strong> Keep titles descriptive but concise. Add details
        in the description if needed.
      </p>
    </div>
  </form>
</div>
